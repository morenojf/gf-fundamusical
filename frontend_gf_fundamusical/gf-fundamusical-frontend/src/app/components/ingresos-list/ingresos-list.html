<ng-template #template>
  <div class="modal-main-content">
    <div class="modal-header">
      <button class="close-modal-x" closeModal>x</button>
    </div>

    <h3 class="modal-title">Confirmar acción</h3>

    <div>
      <p>¿Estas seguro que deseas eliminar esta operación?</p>
    </div>

    <div class="btn-confirmar">
      <button class="btn" (click)="deleteOperacion()" closeModal>Sí</button>
      <button class="btn" closeModal>No</button>
    </div>
  </div>
</ng-template>

<div class="main-content">
  @if (!operacionesFiltered?.length) {
  <div class="no-content">
    <p>Sin operaciones registradas...</p>
  </div>
  } @else {
  <table class="operaciones-table">
    <!-- TITULOS DE LA CUADRICULA -->
    <thead>
      <tr>
        <th>#</th>
        <th class="eliminar-th"></th>
        <th>Fecha</th>
        <th>Tipo</th>
        @if (tipoPagina === 'egresos-list' || tipoPagina === 'informes-list') {
        <th>Concepto de gasto</th>
        }
        <th>Descripción</th>
        <th class="referencias-th">Soportes</th>
        <th>N° Referencia</th>
        <th>Monto</th>
      </tr>
    </thead>
    @for (operacion of operacionesFiltered; track $index) { @if
    (operacion.operacionTipo === "INGRESO" && tipoPagina === 'ingresos-list') {

    <!-- INGRESOS -->
    <tbody>
      <tr>
        <!--# ID operacion-->
        <td>
          <p>{{operacion.operacionId}}</p>
        </td>
        <!-- Acciones -->
        <td>
          <button
            class="action-btn disable"
            title="Deshabilitar"
            (click)="confirmActionBtn(operacion)"
          >
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
              <rect
                x="5"
                y="7"
                width="14"
                height="12"
                rx="2"
                stroke="#d63638"
                stroke-width="2"
              />
              <path
                d="M3 7h18"
                stroke="#d63638"
                stroke-width="2"
                stroke-linecap="round"
              />
              <path
                d="M10 11v4"
                stroke="#d63638"
                stroke-width="2"
                stroke-linecap="round"
              />
              <path
                d="M14 11v4"
                stroke="#d63638"
                stroke-width="2"
                stroke-linecap="round"
              />
              <path
                d="M9 7V5a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v2"
                stroke="#d63638"
                stroke-width="2"
              />
            </svg>
          </button>
        </td>
        <!-- Fecha y hora de operacion -->
        <td>
          <p>{{convertDate(operacion.operacionFecha)}}</p>
        </td>
        <!-- Tipo de operación -->
        <td><p>{{operacion.operacionTipo}}</p></td>
        <!--Descripción -->
        <td>
          <p>{{operacion.operacionDescripcion}}</p>
        </td>
        <!-- Soportes -->
        <td class="soportes">
          <a
            href="{{operacion.operacionSoporte}}"
            target="_blank"
            class="link-comprobante"
            >Comprobante</a
          >
        </td>
        <!-- N° Referencia Transacción -->
        <td>{{operacion.operacionRefN}}</td>
        <!-- Monto -->
        <td class="ingreso">+ {{operacion.operacionMonto}}</td>
      </tr>
    </tbody>

    <!-- EGRESOS -->
    } @if (operacion.operacionTipo === "EGRESO" && tipoPagina ===
    'egresos-list') {
    <tbody>
      <tr>
        <!--# ID operacion-->
        <td>
          <p>{{operacion.operacionId}}</p>
        </td>
        <!-- Acciones -->
        <td>
          <button
            class="action-btn disable"
            title="Deshabilitar"
            (click)="confirmActionBtn(operacion)"
          >
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
              <rect
                x="5"
                y="7"
                width="14"
                height="12"
                rx="2"
                stroke="#d63638"
                stroke-width="2"
              />
              <path
                d="M3 7h18"
                stroke="#d63638"
                stroke-width="2"
                stroke-linecap="round"
              />
              <path
                d="M10 11v4"
                stroke="#d63638"
                stroke-width="2"
                stroke-linecap="round"
              />
              <path
                d="M14 11v4"
                stroke="#d63638"
                stroke-width="2"
                stroke-linecap="round"
              />
              <path
                d="M9 7V5a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v2"
                stroke="#d63638"
                stroke-width="2"
              />
            </svg>
          </button>
        </td>
        <!-- Fecha y hora de operacion -->
        <td>
          <p>{{convertDate(operacion.operacionFecha)}}</p>
        </td>
        <!-- Tipo de operación -->
        <td><p>{{operacion.operacionTipo}}</p></td>
        <!-- Partida -->
        <td>
          <p>{{getPartidaName(operacion.partidaId)}}</p>
        </td>
        <!--Descripción -->
        <td>
          <p>{{operacion.operacionDescripcion}}</p>
        </td>
        <!-- Soportes -->

        <td class="soportes">
          <a
            href="{{operacion.operacionSoporte}}"
            target="_blank"
            class="link-comprobante"
            >Comprobante</a
          >
          <a
            href="{{operacion.operacionCarta}}"
            target="_blank"
            class="link-carta"
            >Carta Soporte</a
          >
        </td>

        <!-- N° Referencia Transacción -->
        <td>{{operacion.operacionRefN}}</td>
        <!-- Monto -->
        <td class="egreso">- {{operacion.operacionMonto}}</td>
      </tr>
    </tbody>
    <!-- INFORMES -->
    } @if (tipoPagina === 'informes-list') {

    <tbody>
      <tr>
        <!--# ID operacion-->
        <td>
          <p>{{operacion.operacionId}}</p>
        </td>
        <!-- Acciones -->
        <td>
			@if (userInfo.userRol === 'ADMIN') {
				<div></div>
			} @else {
				<button
				  class="action-btn disable"
				  title="Deshabilitar"
				  (click)="confirmActionBtn(operacion)"
				>
				  <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
					<rect
					  x="5"
					  y="7"
					  width="14"
					  height="12"
					  rx="2"
					  stroke="#d63638"
					  stroke-width="2"
					/>
					<path
					  d="M3 7h18"
					  stroke="#d63638"
					  stroke-width="2"
					  stroke-linecap="round"
					/>
					<path
					  d="M10 11v4"
					  stroke="#d63638"
					  stroke-width="2"
					  stroke-linecap="round"
					/>
					<path
					  d="M14 11v4"
					  stroke="#d63638"
					  stroke-width="2"
					  stroke-linecap="round"
					/>
					<path
					  d="M9 7V5a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v2"
					  stroke="#d63638"
					  stroke-width="2"
					/>
				  </svg>
				</button>
			}
        </td>
        <!-- Fecha y hora de operacion -->
        <td>
          <p>{{convertDate(operacion.operacionFecha)}}</p>
        </td>
        <!-- Tipo de operación -->
        <td><p>{{operacion.operacionTipo}}</p></td>
        <!-- Partida -->
        <td>
          @if (operacion.operacionTipo === 'INGRESO') {
          <p>N/A</p>
          } @else {
          <p>{{getPartidaName(operacion.partidaId)}}</p>
          }
        </td>
        <!--Descripción -->
        <td>
          <p>{{operacion.operacionDescripcion}}</p>
        </td>
        <!-- Soportes -->
        @if (operacion.operacionTipo === "INGRESO") {
        <td>
          <a
            href="{{operacion.operacionSoporte}}"
            target="_blank"
            class="link-comprobante"
            >Comprobante</a
          >
        </td>
        } @else {
        <td class="soportes">
          <a
            href="{{operacion.operacionSoporte}}"
            target="_blank"
            class="link-comprobante"
            >Comprobante</a
          >
          <a
            href="{{operacion.operacionCarta}}"
            target="_blank"
            class="link-carta"
            >Carta Soporte</a
          >
        </td>

        }
        <!-- N° Referencia Transacción -->
        <td>{{operacion.operacionRefN}}</td>
        <!-- Monto -->
        @if (operacion.operacionTipo === "INGRESO") {
        <td class="ingreso">+ {{operacion.operacionMonto}}</td>
        } @else {
        <td class="egreso">- {{operacion.operacionMonto}}</td>
        }
      </tr>
    </tbody>

    } }
  </table>
  }
</div>
